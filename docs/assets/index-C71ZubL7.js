(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const u of t.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&d(u)}).observe(document,{childList:!0,subtree:!0});function n(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function d(e){if(e.ep)return;e.ep=!0;const t=n(e);fetch(e.href,t)}})();const g=["des","tout","grand","petit","même","autre","seul","jeune","premier","bon","quel","beau","vieux","noir","nouveau","dernier","blanc","cher","long","pauvre","plein","vrai","toute","bas","gros","doux","heureux","haut","profond","rouge","ne","pas","plus","bien","si","là","même","tout","encore","aussi","peu","alors","toujours","jamais","non","très","ainsi","moins","ici","oui","et","que","comme","mais","ou","quand","si","puis","donc","car","le","la","les","un","une","des","ce","cette","ces","mon","ton","son","notre","votre","leur","je","tu","il","elle","nous","vous","ils","elles","me","te","se","lui","leur","y","en"],f=a=>{const s={fr:{words:g,commonWords:["le","la","les","un","une","des","et","ou","je","tu","il","elle","nous","vous"],count:0,commonCount:0},en:{words:["the","a","an","and","or","i","you","he","she","we","they","this","that","what"],commonWords:["the","a","an","and","or","i","you","he","she","we"],count:0,commonCount:0},es:{words:["el","la","los","las","un","una","unos","y","o","yo","tu","él","ella","nosotros"],commonWords:["el","la","los","las","un","una","unos","y","o","yo"],count:0,commonCount:0}},n=a.toLowerCase().split(/\s+/),d=n.length;n.forEach(o=>{for(let r in s){const c=s[r];c.commonWords.includes(o)?(c.commonCount++,c.count++):c.words.includes(o)&&c.count++}});const e={};for(let o in s){const r=s[o];e[o]=(r.commonCount*2+r.count)/d*100}let t=Object.keys(e).reduce((o,r)=>e[o]>e[r]?o:r),u=e[t];return{dominantLanguage:t,dominantPercentage:u,percentages:e}},m={detectLanguage:f};window.languageDetection=m;document.addEventListener("DOMContentLoaded",()=>{window.textToSpeech.init().then(()=>{i("Speech synthesis ready"),document.getElementById("speak-button").disabled=!1}).catch(t=>{i(`Error: ${t.message}`,"error"),document.getElementById("speak-button").disabled=!0});const a=document.getElementById("text-input"),s=document.getElementById("voice-select"),n=document.getElementById("speak-button");document.getElementById("status-message");const d=document.getElementById("word-count"),e=document.getElementById("language-stats");a.addEventListener("input",()=>{const t=a.value.trim(),o=t.split(/\s+/).filter(r=>r.length>0).length;if(d.textContent=o,o>500){i("Error: Text exceeds 500 words limit","error"),n.disabled=!0;return}if(o>0){const{dominantLanguage:r,dominantPercentage:c,percentages:l}=m.detectLanguage(t);if(e.innerHTML=`
                Detected languages:<br>
                French: ${l.fr.toFixed(1)}%<br>
                English: ${l.en.toFixed(1)}%<br>
                Spanish: ${l.es.toFixed(1)}%
            `,c<50){i("Error: No dominant language detected (threshold: 50%)","error"),n.disabled=!0;return}n.disabled=!1,i("")}else e.innerHTML="",n.disabled=!0}),n.addEventListener("click",async()=>{const t=a.value.trim();if(!t)return;const{dominantLanguage:u}=m.detectLanguage(t),o=s.value;n.disabled=!0,i("Reading text...");try{await window.textToSpeech.speak(t,u,o),i("Finished reading")}catch(r){i(`Error: ${r.message}`,"error")}finally{n.disabled=!1}})});function i(a,s="info"){const n=document.getElementById("status-message");n.textContent=a,n.className=`status ${s}`}
