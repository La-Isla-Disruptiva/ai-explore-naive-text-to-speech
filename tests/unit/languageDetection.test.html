<!DOCTYPE html>
<html>

<head>
    <title>Language Detection Tests</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://unpkg.com/mocha/mocha.css" />
</head>

<body>
    <div id="mocha"></div>

    <script src="https://unpkg.com/chai/chai.js"></script>
    <script src="https://unpkg.com/mocha/mocha.js"></script>

    <script class="mocha-init">
        mocha.setup('bdd');
        mocha.checkLeaks();
    </script>

    <!-- Load the code to test -->
    <script src="../../src/js/languageDetection.js"></script>

    <!-- Load the test file -->
    <script>
        const { assert } = chai;

        describe('Language Detection', () => {
            const { detectLanguage } = window.languageDetection;

            describe('French Language Detection', () => {
                it('should detect simple French sentence', () => {
                    const text = 'Je suis une phrase en français avec les mots courants.';
                    const result = detectLanguage(text);
                    assert.equal(result.dominantLanguage, 'fr');
                    assert.isAbove(result.dominantPercentage, 60);
                });

                it('should detect complex French text with various words', () => {
                    const text = 'Le petit garçon marche dans le jardin. Il regarde les belles fleurs et écoute les oiseaux chanter au printemps.';
                    const result = detectLanguage(text);
                    assert.equal(result.dominantLanguage, 'fr');
                    assert.isAbove(result.dominantPercentage, 70);
                });

                it('should detect French in academic text', () => {
                    const text = 'La recherche scientifique démontre que les changements climatiques nécessitent une action immédiate et collective.';
                    const result = detectLanguage(text);
                    assert.equal(result.dominantLanguage, 'fr');
                    assert.isAbove(result.dominantPercentage, 65);
                });

                it('should detect French with numbers and punctuation', () => {
                    const text = 'En 2025, plus de 1000 chercheurs travailleront sur ce projet important!';
                    const result = detectLanguage(text);
                    assert.equal(result.dominantLanguage, 'fr');
                    assert.isAbove(result.dominantPercentage, 60);
                });
            });

            it('should detect English as dominant language', () => {
                const text = 'This is a sentence in English with common words.';
                const result = detectLanguage(text);
                assert.equal(result.dominantLanguage, 'en');
                assert.isAbove(result.dominantPercentage, 50);
            });

            it('should detect Spanish as dominant language', () => {
                const text = 'Esta es una frase en español con palabras comunes.';
                const result = detectLanguage(text);
                assert.equal(result.dominantLanguage, 'es');
                assert.isAbove(result.dominantPercentage, 50);
            });

            it('should handle mixed language text', () => {
                const text = 'This is mixed con algunas palabras en español and some mots en français.';
                const result = detectLanguage(text);
                assert.isBelow(result.dominantPercentage, 50);
            });

            it('should handle empty text', () => {
                const result = detectLanguage('');
                assert.equal(result.dominantPercentage, 0);
            });
        });
    </script>

    <script class="mocha-exec">
        mocha.run();
    </script>
</body>

</html>